<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>QA Update Automation</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename= 'css/style.css') }}">
        <!--<link rel="stylesheet" type="text/css" href="../static/css/style.css">-->
    </head>
    <body>


    <div class="heading-box">
        <h1>QA Update Automation</h1>
        <p>Center for Instructional Design and Innovation - USU</p>
        <p>Created and maintained by Emma Lynn (a02391851@usu.edu)</p>
        <a href="https://github.com/emmalynnnn/cidi-monday-QA-automation">[Source]</a>
    </div>

    <br>

    <h2>Update the QA Board</h2>

    <div id="ally-box" class="feature-box blue">
        <br>
        <h3>1. Get the Ally Download Link</h3>

        <form method="POST" action="/getAllyLink">
            <button type="submit" class="btn btn-light button">Get Link</button>
        </form>
        <br>
        <p>Note: it may take a few minutes for the link to be generated.</p>

        <!--<p>{{ link }}</p>-->
        {% if status %}
            <p id="status-marker">{{ status }}</p>
        {% endif %}

    </div>
    <div class="feature-box blue">
        <br>

        <h3>2. Upload the Ally File</h3>

        <p>Unzip the Ally folder and upload the file called courses.csv here for processing.</p>
        <form method="POST" action="/processAllyFile" enctype="multipart/form-data">
            <input type="file" id="allyFile" name="allyFile"/>
            <br><br>

            <button type="submit" class="btn btn-light button">Upload</button>
        </form>

        <br>

    </div>

    <div class="feature-box blue">
        <br>
        <h3>3. Run the Update</h3>
        <br>

        <form method="POST" action="/updating">
            <div class="form-group">
                <p>Select 'Update existing board' if you are updating a board that already exists (mid-semester).
            Select 'Fill in new board' if you are filling in a completely blank board at the beginning of a semester. </p>
                <label for="trigger-type">Update Type</label>
                <select name="trigger-type" class="form-select">
                    <option value=""></option>
                    <option value="update">Update existing board</option>
                    <option value="new">Fill in new board</option>
                </select>

                <br>
                <p>Select 'Update existing board' if you are updating a board that already exists (mid-semester).
            Select 'Fill in new board' if you are filling in a completely blank board at the beginning of a semester. </p>
                <label for="board-id">Board ID</label>
                <input type="text" name="board-id" class="form-control" value="{{ request.form['board-id'] }}"></input>


                <br>
                <p>Select 'Update existing board' if you are updating a board that already exists (mid-semester).
            Select 'Fill in new board' if you are filling in a completely blank board at the beginning of a semester. </p>
                <label for="cr-box-id">Course Report File Box ID</label>
                <input type="text" name="cr-box-id" class="form-control" value="{{ request.form['cr-box-id'] }}"></input>
            </div>

            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    {% for message in messages %}
                        <p class="feature-box error-message">Error: {{ message }}</p>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <br>

            <p class="error-message">WARNING: Update process cannot be stopped once began!!</p>

            <div class="form-group">
                <button type="submit" class="btn btn-light button">Submit</button>
            </div>

            <br>
        </form>

    </div>

    <script src="{{ url_for('static', filename= 'js/linkStatus.js') }}" type="text/javascript"></script>

    </body>
</html>
